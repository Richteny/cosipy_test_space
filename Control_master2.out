20
0.01579778830963665
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ alb_input           │ (None, 92, 9)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ snowlines_input     │ (None, 79, 9)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional_2     │ (None, 92, 128)   │     37,888 │ alb_input[0][0]   │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ mass_balance_input  │ (None, 7)         │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional       │ (None, 79, 128)   │     37,888 │ snowlines_input[… │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional_3     │ (None, 92, 128)   │     98,816 │ bidirectional_2[… │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 64)        │        512 │ mass_balance_inp… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional_1     │ (None, 79, 128)   │     98,816 │ bidirectional[0]… │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d (Conv1D)     │ (None, 92, 64)    │     16,448 │ bidirectional_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 128)       │      8,320 │ dense[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_3 (Dense)     │ (None, 79, 128)   │     16,512 │ bidirectional_1[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_6 (Dense)     │ (None, 92, 128)   │      8,320 │ conv1d[0][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout (Dropout)   │ (None, 128)       │          0 │ dense_1[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_4 (Dense)     │ (None, 79, 64)    │      8,256 │ dense_3[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_7 (Dense)     │ (None, 92, 64)    │      8,256 │ dense_6[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 64)        │      8,256 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_5 (Dense)     │ (None, 79, 1)     │         65 │ dense_4[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_8 (Dense)     │ (None, 92, 1)     │         65 │ dense_7[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ mass_balance_output │ (None, 1)         │         65 │ dense_2[0][0]     │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ snowlines_output    │ (None, 79)        │          0 │ dense_5[0][0]     │
│ (Reshape)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ alb_output          │ (None, 92)        │          0 │ dense_8[0][0]     │
│ (Reshape)           │                   │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,045,451 (3.99 MB)
 Trainable params: 348,483 (1.33 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 696,968 (2.66 MB)
      rrr_factor   alb_ice  alb_snow  ...     sim77  sim78  sim79
0       0.706516  0.145356  0.918285  ...  0.420635    0.0    0.0
1       0.587514  0.196494  0.917633  ...  0.436508    0.0    0.0
2       0.995854  0.139976  0.929916  ...  0.373016    0.0    0.0
3       1.121417  0.223485  0.918527  ...  0.388889    0.0    0.0
4       0.676225  0.180963  0.903915  ...  0.420635    0.0    0.0
...          ...       ...       ...  ...       ...    ...    ...
2495    0.831364  0.132287  0.921126  ...  0.404762    0.0    0.0
2496    1.281349  0.158910  0.915489  ...  0.261905    0.0    0.0
2497    0.696511  0.219316  0.929494  ...  0.420635    0.0    0.0
2498    1.132456  0.208113  0.920521  ...  0.357143    0.0    0.0
2499    0.989007  0.182165  0.912091  ...  0.404762    0.0    0.0

[2500 rows x 87 columns]
[{'rrrfactor': 0.6287784658954779, 'albsnow': 0.9222765285717779, 'albice': 0.18961741612888033, 'albfirn': 0.641732472753171, 'albaging': 11.476314117957067, 'albdepth': 10.539360645396242, 'iceroughness': 11.873260395131728}, {'rrrfactor': 1.1191194040109198, 'albsnow': 0.8901801011308413, 'albice': 0.21299008191729246, 'albfirn': 0.6510355527652831, 'albaging': 7.265542975803456, 'albdepth': 1.9643727699152618, 'iceroughness': 19.184207558946312}, {'rrrfactor': 0.8601355891611377, 'albsnow': 0.9013749380217881, 'albice': 0.15056761755107875, 'albfirn': 0.5279763475741561, 'albaging': 15.205615945049034, 'albdepth': 13.943999641273171, 'iceroughness': 3.59530539033866}, {'rrrfactor': 1.0982735060792823, 'albsnow': 0.9110249012923765, 'albice': 0.12007839037623035, 'albfirn': 0.5829148507701605, 'albaging': 21.14312984415555, 'albdepth': 6.012589532756236, 'iceroughness': 9.560909397962119}]
0.01579778830963665
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ alb_input           │ (None, 92, 9)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ snowlines_input     │ (None, 79, 9)     │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional_2     │ (None, 92, 128)   │     37,888 │ alb_input[0][0]   │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ mass_balance_input  │ (None, 7)         │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional       │ (None, 79, 128)   │     37,888 │ snowlines_input[… │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional_3     │ (None, 92, 128)   │     98,816 │ bidirectional_2[… │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 64)        │        512 │ mass_balance_inp… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ bidirectional_1     │ (None, 79, 128)   │     98,816 │ bidirectional[0]… │
│ (Bidirectional)     │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d (Conv1D)     │ (None, 92, 64)    │     16,448 │ bidirectional_3[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 128)       │      8,320 │ dense[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_3 (Dense)     │ (None, 79, 128)   │     16,512 │ bidirectional_1[… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_6 (Dense)     │ (None, 92, 128)   │      8,320 │ conv1d[0][0]      │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout (Dropout)   │ (None, 128)       │          0 │ dense_1[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_4 (Dense)     │ (None, 79, 64)    │      8,256 │ dense_3[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_7 (Dense)     │ (None, 92, 64)    │      8,256 │ dense_6[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 64)        │      8,256 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_5 (Dense)     │ (None, 79, 1)     │         65 │ dense_4[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_8 (Dense)     │ (None, 92, 1)     │         65 │ dense_7[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ mass_balance_output │ (None, 1)         │         65 │ dense_2[0][0]     │
│ (Dense)             │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ snowlines_output    │ (None, 79)        │          0 │ dense_5[0][0]     │
│ (Reshape)           │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ alb_output          │ (None, 92)        │          0 │ dense_8[0][0]     │
│ (Reshape)           │                   │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,045,451 (3.99 MB)
 Trainable params: 348,483 (1.33 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 696,968 (2.66 MB)
      rrr_factor   alb_ice  alb_snow  ...     sim77  sim78  sim79
0       0.706516  0.145356  0.918285  ...  0.420635    0.0    0.0
1       0.587514  0.196494  0.917633  ...  0.436508    0.0    0.0
2       0.995854  0.139976  0.929916  ...  0.373016    0.0    0.0
3       1.121417  0.223485  0.918527  ...  0.388889    0.0    0.0
4       0.676225  0.180963  0.903915  ...  0.420635    0.0    0.0
...          ...       ...       ...  ...       ...    ...    ...
2495    0.831364  0.132287  0.921126  ...  0.404762    0.0    0.0
2496    1.281349  0.158910  0.915489  ...  0.261905    0.0    0.0
2497    0.696511  0.219316  0.929494  ...  0.420635    0.0    0.0
2498    1.132456  0.208113  0.920521  ...  0.357143    0.0    0.0
2499    0.989007  0.182165  0.912091  ...  0.404762    0.0    0.0

[2500 rows x 87 columns]
[{'rrrfactor': 1.0080466904609253, 'albsnow': 0.8995824557807751, 'albice': 0.17402010455297934, 'albfirn': 0.5998315661481229, 'albaging': 6.5521056298687235, 'albdepth': 1.2143613331038818, 'iceroughness': 6.57304662152822}, {'rrrfactor': 1.2337595049086618, 'albsnow': 0.8956852521613237, 'albice': 0.15258530829960368, 'albfirn': 0.6875739208340834, 'albaging': 19.00766824201209, 'albdepth': 4.766489868136224, 'iceroughness': 2.4345410673339423}, {'rrrfactor': 0.8727827817513983, 'albsnow': 0.9155769100746276, 'albice': 0.12127045126320472, 'albfirn': 0.53859784571916, 'albaging': 22.30551028666888, 'albdepth': 7.87816788601686, 'iceroughness': 12.202261583764884}, {'rrrfactor': 0.673008201978494, 'albsnow': 0.9204010780494534, 'albice': 0.22740079784056344, 'albfirn': 0.562738669443421, 'albaging': 12.124343116274689, 'albdepth': 13.884518921889216, 'iceroughness': 15.734554601525112}]
